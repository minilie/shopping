# 《移动互联网编程实践》课程大作业

**版本：** 1.1

**华为技术有限公司**

---

## 1 作业导读

### 1.1 作业导读

本篇为商城，旨在帮助学生熟练的掌握程序设计以及如何分析和设计程序的功能。

完成作业需经历五个阶段：分析设计、绘制商品页面、加载页面、支持列表滑动、支持更多品类。

当然，如果同学们有自己的想法完成自己设计的软件内容，也可以自由选题。但注意，自由选题的同学们额外需要自己仿照下述内容，设计绘制必要的 UML 图表、明确自己选题的内容任务难点、详述软件理想效果。

*   **使用环境：** 本作业要求在鸿蒙真机/模拟器上进行，以此让学生体验解决问题的过程。
*   **使用操作系统：** HarmonyOS Next。
*   **使用工具：** DevEco Studio。

**作业提交要求：**

1.  **需求分析：** 针对设计制品的应用需求，详细描述其可能涉及的功能性与非功能性的各项需求，通过绘制必要的 UML 图表（如用例图、类图、状态图等），确保需求明确、完整、可验证。
2.  **架构设计：** 涵盖系统总体设计架构、各模块详细设计、数据库设计、接口设计、界面设计等内容，需绘制必要的 UML 图表（如构件图、活动图、顺序图等），为系统开发提供清晰指导。
3.  **系统测试：** 展示测试的全方位规划、具体用例设计以及最终测试结果和结论，证明系统达到预期质量标准，并且可进行量化测试的内容都需要进行量化验证。
4.  **项目管理：** 假设项目执行期为 2 个月，项目组成员为分组实际人员情况，策划包括项目计划、团队成员分工说明、进度跟踪记录，以及风险管理等内容的项目管理文档，要求体现项目管理的规范性和有效性。
5.  **系统原型与实现代码：** 系统原型的关键技术评估点包括：提交材料：代码和数据文件。
6.  **个人心得：** 各组组长额外提供 1 份关于各个组员的角色分工及其工作情况说明，组长和所有组员每人提供一份 400 字以内的个人实践心得。
7.  **展示视频：** 功能展示视频，需要录制一份展示功能实现完整的视频。

---

## 2 商城

### 2.1 功能要求

HarmonyOS ArkTS 提供丰富的接口和组件，开发者可以根据实际场景和开发需求，选用不同的组件和接口。我们使用 `Scroll` 组件、`List` 组件以及 `LazyForEach` 组件实现一个商品列表的页面，并且拥有下拉刷新、懒加载和到底提示的效果。

**核心业务：**
1.  **商品浏览：** （有缩略图、关键词介绍、首页瀑布流、高矮图共存等）
2.  **分类 Tab：** （三步内找到目标品类：点 Tab → 看子类 → 进列表浏览商品）
3.  **搜索：** （输入关键词 → 点结果）
4.  **筛选：** （让用户“按意愿排序”，同时可叠加多重过滤条件，缩小选择范围）

### 2.2 作业要求

**目的：** 完成上述功能实现。
**技术要求：** 掌握基础的 ArkTS 程序编写，掌握基础的 DevEco Studio 使用，掌握基础的开发编译以及调试的使用，禁止在作业内容中混用 JS/JAVA 等其他编程语言。

**相关概念：**
*   **Scroll：** 可滚动的容器组件，当子组件的布局尺寸超过父组件的视口时，内容可以滚动。
*   **List：** 列表包含一系列相同宽度的列表项。适合连续、多行呈现同类数据，例如图片和文本。
*   **Tabs：** 一种可以通过页签进行内容视图切换的容器组件，每个页签对应一个内容视图。
*   **LazyForEach：** 开发框架提供数据懒加载（LazyForEach 组件）从提供的数据源中按需迭代数据，并在每次迭代过程中创建相应的组件。

### 2.3 代码介绍

**[项目目录结构描述]：**
```text
entry/src/main/ets                    // 代码区
├── common
│   └── CommonConstants.ets           // 常量集合文件
├── entryability
│   └── EntryAbility.ets              // 应用入口，承载应用的生命周期
├── pages
│   └── ListIndex.ets                 // 页面入口
├── view
│   ├── GoodsListComponent.ets        // 商品列表组件
│   ├── PutDownRefreshLayout.ets      // 下拉刷新组件
│   └── TabBarsComponent.ets          // Tabs 组件
└── viewmodel
    ├── InitialData.ets               // 初始化数据
    └── ListDataSource.ets            // List 使用的相关数据加载

entry/src/main/resources              // 资源文件目录
```

**参考链接：**
[https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_NEXT-List](https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_NEXT-List)

---

### 2.3.1 页面布局

页面使用 `Navigation` 与 `Tabs` 做页面布局，使用 `Navigation` 的 `title` 属性实现页面的标题，`Tabs` 做商品内容的分类。

页面分为“精选”、“手机”、“服饰”、“穿搭”、“家居”五个模块，推荐同学们将“精选”部分单独编写代码，其余模块使用 `ForEach` 遍历生成。无论生成方式，需要保证各模块 Tab 样式相同，各 Tab 中需要添加 `SelectedComponent`、`Banner`、`WaterfallList`、`RefreshLayout` 组件，注意组件之间的层叠关系以及数据与事件的传递。

### 2.3.2 商品列表的懒加载

使用 `Scroll` 嵌套 `List` 做长列表，让各组件的高度保持统一，实现 `Scroll` 与 `List` 的联动。
商品列表往往数据量很多，如果使用 `ForEach` 一次性遍历生成的话，性能不好，所以这里使用 `LazyForEach` 进行数据的懒加载，推荐使用剩余 6 条商品时就提前进行拉取。

当向下滑动，需要加载新的数据时，再将新数据加载出来，生成新的列表。通过 `onTouch` 事件来触发懒加载行为，当商品列表向下滑动，加载新的数据。
推荐使用 20 条作为首次加载，后续每次 20 条作为增量更新，保持 ≥40fps 帧率，中间不掉帧即可。

### 2.3.3 下拉刷新与到底提示

下拉刷新同样使用 `TouchEvent` 做下拉判断，当下拉的偏移量超出将要刷新的偏移量时，就展示下拉刷新的布局，同时使用条件渲染判断是否显示下拉刷新布局。这里额外提出要求，需要考虑异常保护，下拉的动画如果遇到了网络延迟如何应对。

列表到底提示“已经到底了”并回弹的效果使用了 `Scroll` 的 `edgeEffect` 来控制回弹，尽量使用系统级弹簧，就无需手写动画，但需要自己控制回弹距离。

---

**[图片内容描述：商城应用最终效果图]**
*   **界面顶部：** 显示状态栏（时间08:08、电量、信号等）和标题栏，标题为“商城”。
*   **分类导航：** 具有五个选项卡：精选（已选中，带下划线）、手机、服饰、穿搭、家居。
*   **交互状态：** 页面顶部正在下拉，显示“正在刷新”及圆形加载进度图。
*   **商品列表：** 展示了多个商品条目，每个条目包含：
    *   商品左侧缩略图（如植物、饮品等）。
    *   商品标题（如“【新品上市】畅乐冰晶绿低脂新品”）。
    *   简短描述及评价信息（如“6662人评价 95%好评”）。
    *   价格标签（如“¥199”）。
*   **代码下载链接：** [https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_NEXT-List](https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_NEXT-List)
